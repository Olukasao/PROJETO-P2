<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cadastro de Usuários</title>
    <link rel="stylesheet" href="css/cadastro.css" />
  </head>
  <body>
    <div class="container">
      <h2 class="titulo-cadastro">
        Complete com seus dados de contato para descobrir as opções de oferta
      </h2>
      <form id="formCadastro">
        <div class="form-group">
          <input
            type="text"
            id="nome"
            name="nome"
            placeholder="Nome"
            required
          />
        </div>
        <div class="form-group">
          <input
            type="email"
            id="email"
            name="email"
            placeholder="Email"
            required
          />
        </div>

        <div class="form-group">
          <select id="curso" name="curso" required>
            <option value="" disabled selected>Selecione o curso</option>
            <option value="Informática">Informática</option>
            <option value="Enfermagem">Enfermagem</option>
            <option value="Administração">Administração</option>
            <option value="Logística">Logística</option>
            <option value="Marketing">Marketing</option>
            <option value="Segurança do Trabalho">Segurança do Trabalho</option>
            <option value="Eletrotécnica">Eletrotécnica</option>
            <option value="Automação Industrial">Automação Industrial</option>
          </select>
        </div>

        <div class="form-group">
          <button type="submit">Cadastrar</button>
        </div>
      </form>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("formCadastro")
          .addEventListener("submit", function (event) {
            event.preventDefault();
            adicionarUsuario();
          });
      });

      function adicionarUsuario() {
        const nome = document.getElementById("nome").value.trim();
        const email = document.getElementById("email").value.trim();
        const curso = document.getElementById("curso").value;

        if (nome && email && curso) {
          const novoUsuario = { nome, email, curso };
          enviarUsuarioParaServidor(novoUsuario);
        } else {
          alert("Por favor, preencha todos os campos.");
        }
      }

      async function enviarUsuarioParaServidor(usuario) {
        const API_URL = "http://localhost:3000/usuarios";
        try {
          const response = await fetch(API_URL, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(usuario),
          });
          if (!response.ok) {
            throw new Error("Erro ao adicionar usuário");
          }
          window.location.href = "index.html"; // Redireciona para outra página após o cadastro
          alert("Usuário cadastrado com sucesso! Verifique seu email!!");
        } catch (error) {
          console.error("Erro:", error);
          alert(
            "Ocorreu um erro ao cadastrar usuário. Por favor, tente novamente."
          );
        }
      }
    </script>

    <script src="js/index.js"></script>
  </body>
</html>
